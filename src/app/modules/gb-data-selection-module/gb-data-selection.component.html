<div class="gb-data-selection-container">
  <!-- The data selection overview panel -->
  <div class="gb-data-selection-overview-panel">
    <div class="row">
      <div class="col-3">
        <span *ngIf="!isLoadingPatientCount_2">
          {{patientCount_2}} {{singularOrPlural('subject', patientCount_2)}}
        </span>
        <span *ngIf="isLoadingPatientCount_2">
          <i class="fa fa-spinner fa-pulse fa-1x fa-fw"></i> subjects
        </span>
      </div>
      <div class="col-6">
        <div class="row">
          <span *ngIf="!isLoadingObservationCount_2">
            {{observationCount_2}} {{singularOrPlural('observation', observationCount_2)}}
          </span>
          <span *ngIf="isLoadingObservationCount_2">
            <i class="fa fa-spinner fa-pulse fa-1x fa-fw"></i> observations
          </span>
        </div>
        <div class="row">
          <span *ngIf="!isLoadingConceptCount_2">
            {{conceptCount_2}} {{singularOrPlural('concept', conceptCount_2)}}
          </span>
          <span *ngIf="isLoadingConceptCount_2">
            <i class="fa fa-spinner fa-pulse fa-1x fa-fw"></i> concepts
          </span>
        </div>
        <div class="row">
          <span *ngIf="!isLoadingStudyCount_2">
            {{studyCount_2}} {{singularOrPlural('study', studyCount_2)}}
          </span>
          <span *ngIf="isLoadingStudyCount_2">
            <i class="fa fa-spinner fa-pulse fa-1x fa-fw"></i> studies
          </span>
        </div>
      </div>
      <div class="col-3">
        <div class="row">
          <input id="queryName" type="text"
                 class="form-control gb-data-selection-overview-panel-input"
                 placeholder="Query name"
                 (drop)="preventNodeDrop($event)"
                 [(ngModel)]="queryName" >
        </div>
        <div class="row">
          <button class="btn btn-outline-secondary btn-sm gb-data-selection-overview-panel-save-btn"
                  (click)="saveQuery()"
                  type="button">Save query</button>
        </div>
        <div class="row">
          <input id="queryFileUpload"
                 type="file"
                 style="display: none"/>
          <button class="btn btn-outline-secondary btn-sm gb-data-selection-overview-panel-import-btn"
                  (click)="importQuery()"
                  type="button">Import query</button>
        </div>
      </div>
    </div>
  </div>

  <p-messages [(value)]="constraintService.alertMessages"></p-messages>

  <!-- The accordions -->
  <md2-accordion [multiple]="false"
                 (open)="openAccordion($event)"
                 (close)="closeAccordion($event)">
    <!-- The 1st step -->
    <md2-accordion-tab [active]="true">
      <md2-accordion-header>
        <span class="gb-data-selection-accordion-header">Step 1: Define the group of subjects for which you
          want to select data</span>
        <!--<span class="gb-data-selection-accordion-sub-header">-->
          <!--({{patientCount_1}} {{singularOrPlural('patient', patientCount_1)}},-->
          <!--with {{observationCount_1}} {{singularOrPlural('observation', observationCount_1)}},-->
          <!--in {{conceptCount_1}} {{singularOrPlural('concept', conceptCount_1)}} and-->
          <!--{{studyCount_1}} {{singularOrPlural('study', studyCount_1)}})-->
        <!--</span>-->
      </md2-accordion-header>
      <gb-selection></gb-selection>
    </md2-accordion-tab>

    <!-- The 2nd step -->
    <md2-accordion-tab>
      <md2-accordion-header>
        <span class="gb-data-selection-accordion-header">Step 2: Select the relevant data of your group of
          subjects</span>
        <!--<span class="gb-data-selection-accordion-sub-header">-->
          <!--({{patientCount_2}} {{singularOrPlural('patient', patientCount_2)}},-->
          <!--with {{observationCount_2}} {{singularOrPlural('observation', observationCount_2)}},-->
          <!--in {{conceptCount_2}} {{singularOrPlural('concept', conceptCount_2)}} and-->
          <!--{{studyCount_2}} {{singularOrPlural('study', studyCount_2)}})-->
        <!--</span>-->
      </md2-accordion-header>
      <gb-projection></gb-projection>
    </md2-accordion-tab>

    <md2-accordion-tab>
      <md2-accordion-header>
        <span class="gb-data-selection-accordion-header">Step 3: Visualize the selected data (optional)</span>
      </md2-accordion-header>
      Visualization
    </md2-accordion-tab>

    <md2-accordion-tab>
      <md2-accordion-header>
        <span class="gb-data-selection-accordion-header">Step 4: Export the selected data (optional)</span>
      </md2-accordion-header>
      <gb-export></gb-export>
    </md2-accordion-tab>


  </md2-accordion>
</div>
